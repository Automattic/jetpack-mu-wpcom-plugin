(()=>{var e={90290:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var s=r(99501),n=r(4981),a=r(55609),o=r(94333),i=r(69307),l=r(65736),c=r(3228),p=r(92819),d=r(36161),u=r(90217),g=r(31583),m=r(74087),h=r(65520),_=r(59314);const w=a.MenuItem;class k extends i.Component{constructor(e){super(e),this.state={selectedCategory:this.getDefaultSelectedCategory()}}getFormattedPatternsByPatternSlugs=(0,p.memoize)((e=>{const t=e.reduce(((e,{name:t,title:r="",description:s="",html:a,pattern_meta:o})=>{const i=o?.viewport_width?Number(o.viewport_width):1280;return e[t]={name:t,title:s||r,blocks:a?(0,n.parse)((0,m.Z)(a,this.props.siteInformation)):[],viewportWidth:Math.max(i,320)},e}),{});return this.filterPatternsWithMissingBlocks(t)}));filterPatternsWithMissingBlocks(e){return Object.entries(e).reduce(((e,[t,r])=>((0,d.Z)(r.blocks)&&r.blocks.length||(e[t]=r),e)),{})}getBlocksForSelection=e=>{const t=this.getBlocksByPatternSlug(e);return(0,g.Z)(t,(function(e){return"core/button"===e.name&&void 0!==e.attributes.url&&(e.attributes.url="#"),e}))};componentDidMount(){this.props.isOpen&&this.trackCurrentView()}componentDidUpdate(e){!e.isOpen&&this.props.isOpen&&this.trackCurrentView(),(this.props.isWelcomeGuideActive||this.props.areTipsEnabled)&&this.props.hideWelcomeGuide()}trackCurrentView(){(0,h.Fk)("add-page")}getDefaultSelectedCategory(){const e=this.getPatternCategories();return e?.length?e[0].slug:null}setPattern=e=>{(0,h.E2)(e);const{selectedCategory:t}=this.state;if(this.props.savePatternChoice(e,t),"blank"===e)return this.props.insertPattern("",[]),void this.props.onClose();const r=this.props.patterns.find((t=>t.name===e)),s=(r?.categories||{}).hasOwnProperty("home"),n=this.getBlocksForSelection(e),a=s?null:r?.title||"";n&&n.length?(this.props.insertPattern(a,n),this.props.onClose()):this.props.onClose()};handleCategorySelection=e=>{this.setState({selectedCategory:e})};closeModal=e=>{"blur"!==e?.type?((0,h.GI)(),this.props.onClose()):e.stopPropagation()};getBlocksByPatternSlug(e){return this.getFormattedPatternsByPatternSlugs(this.props.patterns)?.[e]?.blocks??[]}getPatternGroups=()=>{if(!this.props.patterns.length)return null;const e={};for(const t of this.props.patterns)for(const r in t.categories)r in e||(e[r]=t.categories[r]);return(0,u.x)(["featured","about","blog","home","gallery","services","contact"],e)};getPatternsForGroup=e=>{if(!this.props.patterns.length)return null;if("blank"===e)return[{name:"blank",title:"Blank",html:"",ID:null}];const t=[];for(const r of this.props.patterns)for(const s in r.categories)s===e&&t.push(r);return t};getPatternCategories=()=>{const e=this.getPatternGroups();if(!e)return null;const t=[];for(const r in e)t.push({slug:r,name:e[r].title});return t};renderPatternGroup=()=>{const{selectedCategory:e}=this.state;if(!e)return null;const t=this.getPatternsForGroup(e);return t?.length?this.renderPatternsList(t):null};renderPatternsList=e=>{if(!e.length)return null;const t=this.getFormattedPatternsByPatternSlugs(this.props.patterns),r=Object.keys(t),n=(a=r,e.filter((e=>a.includes(e.name))));var a;return n.length?(0,s.jsx)(_.Z,{label:(0,l.__)("Layout","jetpack-mu-wpcom"),patterns:n.map((e=>t[e.name])),onPatternSelect:this.setPattern}):null};render(){const{selectedCategory:e}=this.state,{isOpen:t,instanceId:r}=this.props;return t?(0,s.jsx)(a.Modal,{title:"",className:"page-pattern-modal",onRequestClose:this.closeModal,aria:{labelledby:`page-pattern-modal__heading-${r}`,describedby:`page-pattern-modal__description-${r}`},children:(0,s.jsxs)("div",{className:"page-pattern-modal__inner",children:[(0,s.jsxs)("div",{className:"page-pattern-modal__sidebar",children:[(0,s.jsx)("h1",{id:`page-pattern-modal__heading-${r}`,className:(0,c.Z)("page-pattern-modal__heading",{"page-pattern-modal__heading--default":!this.props.title}),children:this.props.title||(0,l.__)("Add a page","jetpack-mu-wpcom")}),(0,s.jsx)("p",{id:`page-pattern-modal__description-${r}`,className:"page-pattern-modal__description",children:this.props.description||(0,l.__)("Pick a pre-defined layout or start with a blank page.","jetpack-mu-wpcom")}),(0,s.jsxs)("div",{className:"page-pattern-modal__button-container",children:[(0,s.jsx)(a.Button,{variant:"secondary",onClick:()=>this.setPattern("blank"),className:"page-pattern-modal__blank-button",children:(0,l.__)("Blank page","jetpack-mu-wpcom")}),(0,s.jsx)("select",{className:"page-pattern-modal__mobile-category-dropdown",value:e??void 0,onChange:e=>this.handleCategorySelection(e.currentTarget.value),children:this.getPatternCategories()?.map((({slug:e,name:t})=>(0,s.jsx)("option",{value:e,children:t},e)))})]}),(0,s.jsx)(a.VisuallyHidden,{as:"h2",id:`page-pattern-modal__list-heading-${r}`,children:(0,l.__)("Page categories","jetpack-mu-wpcom")}),(0,s.jsx)(a.NavigableMenu,{className:"page-pattern-modal__category-list",orientation:"vertical","aria-labelledby":`page-pattern-modal__list-heading-${r}`,onNavigate:(e,t)=>this.handleCategorySelection(t.dataset.slug??null),children:this.getPatternCategories()?.map((({slug:t,name:r})=>(0,s.jsx)(w,{variant:"tertiary","aria-selected":t===e,"data-slug":t,onClick:()=>this.handleCategorySelection(t),className:"page-pattern-modal__category-button",tabIndex:t===e?void 0:-1,children:(0,s.jsx)("span",{className:"page-pattern-modal__category-item-selection-wrapper",children:r})},t)))})]}),(0,s.jsx)("div",{className:"page-pattern-modal__pattern-list-container",children:this.renderPatternGroup()})]})}):null}}const f=(0,o.withInstanceId)(k)},59314:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var s=r(99501),n=r(52175),a=r(55609),o=r(94333),i=r(69307);const l=()=>{},c=(0,i.memo)((0,o.withInstanceId)((({instanceId:e,label:t,patterns:r=[],onPatternSelect:i=l})=>{const c=(0,o.useAsyncList)(r);return Array.isArray(r)&&r.length?(0,s.jsx)(a.BaseControl,{id:`pattern-selector-control__${e}`,label:t,className:"pattern-selector-control",children:(0,s.jsx)(n.__experimentalBlockPatternsList,{blockPatterns:r,shownPatterns:c,onClickPattern:e=>i(e.name)})}):null})))},36161:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});const s=function e(t){return!!t.find((t=>"core/missing"===t.name||!(!t.innerBlocks||!t.innerBlocks.length)&&e(t.innerBlocks)))}},90217:(e,t,r)=>{"use strict";function s(e,t){const r=Object.keys(t),s=e.filter((e=>r.includes(e))),n=r.filter((t=>!e.includes(t)));return s.concat(n.sort()).reduce(((e,r)=>(e[r]=t[r],e)),{})}r.d(t,{x:()=>s})},31583:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(4981);const n=function e(t,r){return t.map((t=>((t=r((0,s.cloneBlock)(t))).innerBlocks&&t.innerBlocks.length&&(t.innerBlocks=e(t.innerBlocks,r)),t)))}},74087:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var s=r(65736);const n={Address:(0,s._x)("123 Main St","default address","jetpack-mu-wpcom"),Phone:(0,s._x)("555-555-5555","default phone number","jetpack-mu-wpcom"),CompanyName:(0,s._x)("Your Company Name","default company name","jetpack-mu-wpcom"),Vertical:(0,s._x)("Business","default vertical name","jetpack-mu-wpcom")},a={CompanyName:"title",Address:"address",Phone:"phone",Vertical:"vertical"};function o(e,t){return e in t}const i=(e,t={})=>e?e.replace(/{{(\w+)}}/g,((e,r)=>{const s=o(r,n)?n[r]:"",i=o(r,a)?a[r]:"";return t[i]||s||r})):""},65520:(e,t,r)=>{"use strict";r.d(t,{E2:()=>i,Fk:()=>a,GI:()=>o,Z:()=>n}),window._tkq=window._tkq||[];let s=null;const n=e=>{s=e,window._tkq.push(["identifyUser",e.userid,e.username])},a=e=>{s&&window._tkq.push(["recordEvent","a8c_full_site_editing_template_selector_view",{blog_id:s.blogid,source:e}])},o=()=>{s&&window._tkq.push(["recordEvent","a8c_full_site_editing_template_selector_dismiss",{blog_id:s.blogid}])},i=e=>{s&&window._tkq.push(["recordEvent","a8c_full_site_editing_template_selector_template_selected",{blog_id:s.blogid,pattern:e}])}},39304:(e,t,r)=>{"use strict";r.d(t,{P:()=>g});var s=r(82674),n=r.n(s),a=r(90290),o=r(9818),i=r(69307),l=r(92694),c=r(65736),p=r(60638);r(40462);const __=c.__,d="isInsertingPagePattern",u="automattic/full-site-editing/inserting-pattern";function g(e){const{setOpenState:t}=(0,o.useDispatch)(p.I),{setUsedPageOrPatternsModal:r}=(0,o.useDispatch)("automattic/wpcom-welcome-guide"),{replaceInnerBlocks:s}=(0,o.useDispatch)("core/block-editor"),{editPost:c}=(0,o.useDispatch)("core/editor"),{toggleFeature:g}=(0,o.useDispatch)("core/edit-post"),{disableTips:m}=(0,o.useDispatch)("core/nux"),h=(0,o.useSelect)((e=>{const{isOpen:t,isPatternPicker:r}=e(p.I);return{isOpen:t(),isWelcomeGuideActive:e("core/edit-post").isFeatureActive("welcomeGuide"),areTipsEnabled:!!e("core/nux")&&e("core/nux").areTipsEnabled(),...r()&&{title:__("Choose a Pattern","jetpack-mu-wpcom"),description:__("Pick a pre-defined layout or continue with a blank page","jetpack-mu-wpcom")}}}),[]),{getMeta:_,postContentBlock:w}=(0,o.useSelect)((e=>({getMeta:()=>e("core/editor").getEditedPostAttribute("meta"),postContentBlock:e("core/editor").getBlocks().find((e=>"a8c/post-content"===e.name))})),[]),k=(0,i.useCallback)(((e,t)=>{const r=_(),s=Array.isArray(r._wpcom_template_layout_category)&&r._wpcom_template_layout_category||[];c({meta:{...r,_starter_page_template:e,_wpcom_template_layout_category:[...s,t]}})}),[c,_]),f=(0,i.useCallback)(((e,t)=>{(0,l.addFilter)(d,u,(()=>!0)),e&&c({title:e}),s(w?w.clientId:"",t,!1),(0,l.removeFilter)(d,u)}),[c,w,s]),{isWelcomeGuideActive:b,areTipsEnabled:P}=h,y=(0,i.useCallback)((()=>{b?g("welcomeGuide"):P&&m()}),[P,m,b,g]),x=(0,i.useCallback)((()=>{t("CLOSED"),r?.()}),[t,r]);return React.createElement(a.Z,n()({},h,{onClose:x,savePatternChoice:k,insertPattern:f,hideWelcomeGuide:y},e))}},60638:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});var s=r(9818);const n=(0,s.createReduxStore)("automattic/starter-page-layouts",{reducer:(e="CLOSED",{type:t,...r})=>"SET_IS_OPEN"===t?r.openState:e,actions:{setOpenState:e=>({type:"SET_IS_OPEN",openState:e||"CLOSED"})},selectors:{isOpen:e=>"CLOSED"!==e,isPatternPicker:e=>"OPEN_FOR_BLANK_CANVAS"===e}});(0,s.register)(n)},99501:e=>{"use strict";e.exports=window.ReactJSXRuntime},92819:e=>{"use strict";e.exports=window.lodash},52175:e=>{"use strict";e.exports=window.wp.blockEditor},4981:e=>{"use strict";e.exports=window.wp.blocks},55609:e=>{"use strict";e.exports=window.wp.components},94333:e=>{"use strict";e.exports=window.wp.compose},9818:e=>{"use strict";e.exports=window.wp.data},69307:e=>{"use strict";e.exports=window.wp.element},92694:e=>{"use strict";e.exports=window.wp.hooks},65736:e=>{"use strict";e.exports=window.wp.i18n},40462:e=>{"use strict";e.exports=window.wp.nux},98817:e=>{"use strict";e.exports=window.wp.plugins},82674:e=>{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3228:(e,t,r)=>{"use strict";function s(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=s(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}r.d(t,{Z:()=>n});const n=function(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=s(e))&&(n&&(n+=" "),n+=t);return n}}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(65520),t=r(9818),s=r(98817),n=r(39304),a=r(60638);const{templates:o=[],tracksUserData:i,screenAction:l}=window.starterPageTemplatesConfig??{};i&&(0,e.Z)(i),"add"===l&&(0,t.dispatch)(a.I).setOpenState("OPEN_FROM_ADD_PAGE"),(0,s.registerPlugin)("page-patterns",{render:()=>React.createElement(n.P,{patterns:o}),icon:void 0})})()})();